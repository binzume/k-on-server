<!DOCTYPE html>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Script-Type" content="text/javascript" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <title>k-on Graph</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.2.1/material.indigo-pink.min.css">
  <script defer src="https://code.getmdl.io/1.2.1/material.min.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>


    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
      google.charts.load('current', {'packages':['line']});
      google.charts.setOnLoadCallback(drawChart);

var hours = 24;

    function drawChart() {

      var jsonData = $.ajax({
          url: "stats/_default/values?limit=" + (hours * 12),
          dataType: "json",
          cache : false
      }).done(function(data){
          var rows = [];
          for (var i=0;i <data.values.length; i++) {
          	var d = data.values[i];
          	rows.push([new Date(d['_timestamp']), d['temp'], d['humid']]);
          }
      var data = new google.visualization.DataTable();
      data.addColumn('date', 'Time');
      data.addColumn('number', 'Temperature');
      data.addColumn('number', 'Humidity');

      data.addRows(rows);

      var options = {
        chart: {
          title: 'k-on graph'
        },
        height: 500,
        series: {
          // Gives each series an axis name that matches the Y-axis below.
          0: {axis: 'Temp'},
          1: {axis: 'Humid'}
        },
        axes: {
          // Adds labels to each axis; they don't have to match the axis names.
          y: {
            Temp: {label: 'Temp(Celsius)', range:{min:10, max:35}},
            Humid: {label: 'Humidity(%)',range:{min:0, max:100}}
          }
        }
      };

        var chart = new google.charts.Line(document.getElementById('chart'));

        chart.draw(data, options);

      });

      }

$(document).ready(function(){
  $('#select_term').change(function(){
    hours = $('#select_term').val() | 0;
    drawChart();
  });
});

    </script>

 </head>
 <body>

<div class="mdl-layout mdl-js-layout mdl-layout--fixed-drawer mdl-layout--fixed-header">
  <header class="mdl-layout__header">
    <div class="mdl-layout__header-row">
      <div class="mdl-layout-spacer"></div>
      <div class="mdl-textfield mdl-js-textfield mdl-textfield--expandable
                  mdl-textfield--floating-label mdl-textfield--align-right">
        <label class="mdl-button mdl-js-button mdl-button--icon"
               for="fixed-header-drawer-exp">
          <i class="material-icons">search</i>
        </label>
        <div class="mdl-textfield__expandable-holder">
          <input class="mdl-textfield__input" type="text" name="sample"
                 id="fixed-header-drawer-exp">
        </div>
      </div>
    </div>
  </header>
  <div class="mdl-layout__drawer">
    <span class="mdl-layout-title">k-on Graph</span>
    <nav class="mdl-navigation">
      <a class="mdl-navigation__link" href="">13F-01(default)</a>
    </nav>
  </div>
  <main class="mdl-layout__content">
    <div class="page-content">
      <div class="mdl-textfield mdl-js-textfield">
        <select id="select_term" class="mdl-textfield__input">
          <option value="6">6h</option>
          <option value="24" selected>24h</option>
          <option value="168">7d</option>
        </select>
      </div>
      <div id="chart" style="width:100%; max-width: 900px; height: 500px"></div>
    </div>
  </main>
</div>

 </body>
</html>
